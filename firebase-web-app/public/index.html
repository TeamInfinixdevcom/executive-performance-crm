<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Performance ICE - CRM</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.20.0/dist/xlsx.full.min.js"></script>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75' font-weight='bold' fill='%234F46E5'>‚¨•</text></svg>">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/calls-styles.css">
    <link rel="stylesheet" href="css/orders-styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px;">
                <div>
                    <h1>‚¨• Executive Performance ICE</h1>
                    <p class="subtitle">Sistema de Gesti√≥n de Clientes | Uso Exclusivo Ejecutivos RCM</p>
                </div>
                
                <div style="text-align: center; display: flex; flex-direction: column; gap: 8px; flex: 1; min-width: 200px;">
                    <p style="color: var(--text-primary); margin: 0; font-size: 0.95rem;">
                        üë§ <span id="userName">Cargando...</span>
                        <span class="notification-bell" id="notificationBell">
                            üîî
                            <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                        </span>
                    </p>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;">
                        <button id="btnAdminPanel" class="btn btn-warning" style="padding: 8px 14px; display: none; font-size: 0.9rem;" onclick="window.location.href='admin.html'">
                            üë®‚Äçüíº Panel Admin
                        </button>
                        <button id="btnLogout" class="btn btn-secondary" style="padding: 8px 14px; font-size: 0.9rem;">
                            üö™ Cerrar Sesi√≥n
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <!-- Pesta√±as de navegaci√≥n -->
            <div class="tabs-container">
                <button class="tab-btn active" onclick="switchTab('clientes')">
                    üë• Mis Clientes
                </button>
                <button class="tab-btn" onclick="switchTab('dashboard')">
                    üìä Dashboard
                </button>
                <button class="tab-btn" onclick="switchTab('metas')">
                    üéØ Metas
                </button>
                <button class="tab-btn" onclick="switchTab('pipeline')">
                    üìà Pipeline
                </button>
                <button class="tab-btn" onclick="switchTab('contactos')">
                    ÔøΩ Seguimiento de Pedidos
                </button>
                <button class="tab-btn" onclick="switchTab('campanas')">
                    üìß Campa√±as
                </button>
                <button class="tab-btn" onclick="switchTab('actividades')">
                    üìû Llamadas
                </button>
                <button class="tab-btn" onclick="switchTab('calendario')">
                    üìÖ Recordatorios
                </button>
            </div>

            <!-- Pesta√±a: Clientes -->
            <div id="tab-clientes" class="tab-content active">
            <!-- Barra de b√∫squeda -->
            <section class="search-section">
                <h2>üîç Buscar Cliente</h2>
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Buscar por nombre, c√©dula o n√∫mero de servicio..." class="search-input">
                    <button id="btnSearch" class="btn btn-primary">Buscar</button>
                    <button id="btnClearSearch" class="btn btn-secondary">Limpiar</button>
                    <select id="filterEstadoPlan" class="filter-select" style="margin-left:8px;">
                        <option value="">Todos los estados</option>
                        <option value="ACTUALIZADO">Actualizado</option>
                        <option value="NO ACTUALIZADO">No Actualizado</option>
                        <option value="PENDIENTE">Pendiente</option>
                    </select>
                </div>
            </section>

            <!-- Secci√≥n de controles -->
            <section class="controls">
                <h2>Mis Clientes</h2>
                <div class="button-group">
                    <button id="btnAddClient" class="btn btn-success">‚ûï Agregar Cliente</button>
                    <button id="btnLoadClients" class="btn btn-primary">üîÑ Actualizar Lista</button>
                    <button id="btnDeleteAllMyClients" class="btn btn-danger">üóëÔ∏è Borrar Todos Mis Clientes</button>
                    <select id="filterSegment" class="filter-select">
                        <option value="">Todos los segmentos</option>
                        <option value="PLATINO">PLATINO</option>
                        <option value="ORO">ORO</option>
                        <option value="PLATA">PLATA</option>
                        <option value="BRONCE">BRONCE</option>
                        <option value="BLACK">BLACK</option>
                    </select>
                </div>
                <div class="stats-bar">
                    <span>Total: <strong id="totalClients">0</strong></span>
                    <span>Platino: <strong id="totalPlatino">0</strong></span>
                    <span>Oro: <strong id="totalOro">0</strong></span>
                    <span>Plata: <strong id="totalPlata">0</strong></span>
                    <span>Bronce: <strong id="totalBronce">0</strong></span>
                    <span>Black: <strong id="totalBlack">0</strong></span>
                </div>
            </section>

            <!-- Formulario para crear/editar cliente -->
            <section id="formSection" class="form-section hidden">
                <h2 id="formTitle">Agregar Nuevo Cliente</h2>
                <form id="clientForm">
                    <!-- Identificaci√≥n -->
                    <h3>üìã Informaci√≥n Personal</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="cedula">C√©dula: *</label>
                            <input type="text" id="cedula" required placeholder="112380702">
                        </div>
                        <div class="form-group">
                            <label for="nombre">Nombre Completo: *</label>
                            <input type="text" id="nombre" required placeholder="ESQUIVEL AGUILAR IVANNIA LUCIA">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Correo Electr√≥nico:</label>
                            <input type="email" id="email" placeholder="cliente@email.com">
                        </div>
                        <div class="form-group">
                            <label for="fechaNacimiento">Fecha de Nacimiento:</label>
                            <input type="date" id="fechaNacimiento">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="domicilio">Domicilio:</label>
                        <input type="text" id="domicilio" placeholder="Direcci√≥n completa">
                    </div>
                    
                    <!-- Servicios -->
                    <h3>üì± Servicios</h3>
                    <div class="form-group">
                        <label for="serviciosMoviles">Servicios M√≥viles Activos:</label>
                        <input type="text" id="serviciosMoviles" placeholder="83033341, 88396969 (separados por coma)">
                        <small>Ingrese los n√∫meros separados por coma</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="serviciosFijos">Servicios Fijos Activos:</label>
                        <input type="text" id="serviciosFijos" placeholder="22801234, 22805678 (separados por coma)">
                        <small>Ingrese los n√∫meros separados por coma</small>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="tipoPlan">Tipo de Plan Suscrito:</label>
                            <input type="text" id="tipoPlan" placeholder="Ej: Plan Pospago 5GB">
                        </div>
                        <div class="form-group">
                            <label for="estadoPlan">Estado del Plan:</label>
                            <select id="estadoPlan">
                                <option value="ACTUALIZADO">Actualizado</option>
                                <option value="NO ACTUALIZADO">No Actualizado</option>
                                <option value="PENDIENTE">Pendiente</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Clasificaci√≥n -->
                    <h3>‚≠ê Clasificaci√≥n</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="segmento">Segmento: *</label>
                            <select id="segmento" required>
                                <option value="">Seleccione...</option>
                                <option value="PLATINO">PLATINO</option>
                                <option value="ORO">ORO</option>
                                <option value="PLATA">PLATA</option>
                                <option value="BRONCE">BRONCE</option>
                                <option value="BLACK">BLACK</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="puntajeScore">Puntaje Score:</label>
                            <input type="number" id="puntajeScore" placeholder="492" min="0" max="999">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="categoriaCrediticia">Categor√≠a Crediticia:</label>
                            <select id="categoriaCrediticia">
                                <option value="">Seleccione...</option>
                                <option value="A">A</option>
                                <option value="B">B</option>
                                <option value="C">C</option>
                                <option value="D">D</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="notas">Notas Importantes:</label>
                            <textarea id="notas" rows="2" placeholder="Informaci√≥n adicional relevante"></textarea>
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button type="submit" class="btn btn-success">üíæ Guardar Cliente</button>
                        <button type="button" id="btnCancelForm" class="btn btn-secondary">‚ùå Cancelar</button>
                    </div>
                </form>
            </section>

            <!-- Secci√≥n de mensajes -->
            <div id="messageBox" class="message-box hidden"></div>

            <!-- Secci√≥n de clientes -->
            <section class="data-section">
                <h2>Clientes Registrados</h2>
                <button id="btnExportClients" class="btn btn-info" style="margin-bottom: 12px;">üì§ Exportar a Excel</button>
                <div id="clientsContainer" class="clients-grid">
                    <p class="empty-message">No hay clientes registrados. Haz clic en "Agregar Cliente" para comenzar.</p>
                </div>
                
                <!-- Controles de paginaci√≥n -->
                <div id="paginationControls" class="pagination-controls hidden">
                    <div class="pagination-info">
                        <span>Mostrando <strong id="showingStart">0</strong> - <strong id="showingEnd">0</strong> de <strong id="totalResults">0</strong> resultados</span>
                        <select id="itemsPerPage" class="filter-select">
                            <option value="5" selected>5 por p√°gina</option>
                            <option value="10">10 por p√°gina</option>
                            <option value="20">20 por p√°gina</option>
                            <option value="50">50 por p√°gina</option>
                        </select>
                    </div>
                    <div class="pagination-buttons">
                        <button id="btnPrevPage" class="btn btn-secondary">‚Üê Anterior</button>
                        <div id="pageNumbers" class="page-numbers"></div>
                        <button id="btnNextPage" class="btn btn-secondary">Siguiente ‚Üí</button>
                    </div>
                </div>
            </section>

            <!-- Modal detalle del cliente -->
            <div id="clientDetailModal" class="modal hidden">
                <div class="modal-content">
                    <span class="modal-close" id="closeModal">&times;</span>
                    <h2 id="modalClientName">Cliente</h2>
                    <div id="clientDetailContent"></div>
                    
                    <!-- Secci√≥n para agregar interacci√≥n -->
                    <div class="interaction-section">
                        <h3>üìû Registrar Interacci√≥n</h3>
                        <form id="interactionForm">
                            <div class="form-group">
                                <label for="interactionType">Tipo:</label>
                                <select id="interactionType" required>
                                    <option value="RENOVACION">Renovaci√≥n</option>
                                    <option value="OFERTA">Oferta de Producto</option>
                                    <option value="CONSULTA">Consulta</option>
                                    <option value="RECLAMO">Reclamo</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="interactionNotes">Notas:</label>
                                <textarea id="interactionNotes" required rows="3" placeholder="Detalles de la interacci√≥n"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="interactionResult">Resultado:</label>
                                <select id="interactionResult" required>
                                    <option value="EXITOSO">Exitoso</option>
                                    <option value="PENDIENTE">Pendiente</option>
                                    <option value="RECHAZADO">Rechazado</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-success">üíæ Guardar Interacci√≥n</button>
                        </form>
                    </div>
                    
                    <!-- Botones de acci√≥n -->
                    <div class="modal-actions">
                        <button id="btnEditClient" class="btn btn-primary">‚úèÔ∏è Editar Cliente</button>
                        <button id="btnDeleteClient" class="btn btn-danger">üóëÔ∏è Eliminar Cliente</button>
                    </div>
                </div>
            </div>
            </div><!-- Fin tab-clientes -->

            <!-- Pesta√±a: Dashboard -->
            <div id="tab-dashboard" class="tab-content">
                <section class="data-section">
                    <h2>üìä Dashboard de M√©tricas</h2>
                    
                    <!-- Gr√°ficos Simples -->
                    <div class="charts-container">
                        <!-- Gr√°fico 1 -->
                        <div class="chart-card">
                            <h3 class="chart-title">üìä Distribuci√≥n por Segmento</h3>
                            <div class="chart-wrapper">
                                <canvas id="segmentChartSimple"></canvas>
                            </div>
                        </div>
                        
                        <!-- Gr√°fico 2 -->
                        <div class="chart-card">
                            <h3 class="chart-title">üìà Tendencia de Clientes</h3>
                            <div class="chart-wrapper">
                                <canvas id="scoreChartSimple"></canvas>
                            </div>
                        </div>
                    </div>
                </section>
                
                <script>
                    // Auto-cargar gr√°ficos cuando se abre la pesta√±a
                    document.getElementById('tab-dashboard').addEventListener('shown.bs.tab', () => {
                        setTimeout(() => loadMetricsData(), 100);
                    }, false);
                    
                    // Tambi√©n cargar al hacer scroll/enfoque
                    document.getElementById('tab-dashboard').addEventListener('click', () => {
                        setTimeout(() => loadMetricsData(), 100);
                    }, false);
                    
                    // Cargar despu√©s de que el DOM est√© listo
                    document.addEventListener('DOMContentLoaded', () => {
                        setTimeout(() => loadMetricsData(), 1000);
                    });
                </script>
            </div><!-- Fin tab-dashboard -->

            <!-- Pesta√±a: Calendario de Recordatorios -->
            <div id="tab-calendario" class="tab-content">
                <section class="data-section">
                    <h2>üìÖ Recordatorios y Notas</h2>
                    
                    <!-- Formulario de recordatorios -->
                    <div class="reminder-form-container">
                        <h3>‚ûï Nuevo Recordatorio</h3>
                        <form id="reminderForm" class="reminder-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="reminderDate">Fecha:</label>
                                    <input type="date" id="reminderDate" required>
                                </div>
                                <div class="form-group">
                                    <label for="reminderTime">Hora:</label>
                                    <input type="time" id="reminderTime">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="reminderTitle">T√≠tulo:</label>
                                <input type="text" id="reminderTitle" placeholder="Ej: Seguimiento a Cliente" required>
                            </div>
                            <div class="form-group">
                                <label for="reminderDescription">Descripci√≥n:</label>
                                <textarea id="reminderDescription" rows="3" placeholder="Detalles del recordatorio"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="reminderClient">Cliente (opcional):</label>
                                <input type="text" id="reminderClient" placeholder="Nombre del cliente">
                            </div>
                            <button type="submit" class="btn btn-success">üíæ Guardar Recordatorio</button>
                        </form>
                    </div>
                    
                    <!-- Lista de recordatorios -->
                    <div class="reminders-list-container">
                        <h3>üìù Mis Recordatorios</h3>
                        <div id="remindersList" class="reminders-list">
                            <p class="empty-message">No hay recordatorios. ¬°Crea uno nuevo!</p>
                        </div>
                    </div>
                </section>
            </div><!-- Fin tab-calendario -->

            <!-- Pesta√±a: Metas -->
            <div id="tab-metas" class="tab-content">
                <section class="main-section">
                    <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <h2 style="color: #333; margin-bottom: 20px;">üìä Dashboard de M√©tricas de Ventas</h2>
                        
                        <!-- Filtros -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div>
                                <label style="font-size: 0.9em; color: #666; margin-bottom: 5px; font-weight: 600; display: block;">Per√≠odo:</label>
                                <select id="periodFilter" style="padding: 10px; border: 2px solid #ddd; border-radius: 5px; width: 100%; font-size: 0.95em;">
                                    <option value="day">Por D√≠a</option>
                                    <option value="month" selected>Por Mes</option>
                                    <option value="year">Por A√±o</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size: 0.9em; color: #666; margin-bottom: 5px; font-weight: 600; display: block;">Seleccionar Fecha:</label>
                                <input type="date" id="dateFilter" style="padding: 10px; border: 2px solid #ddd; border-radius: 5px; width: 100%; font-size: 0.95em;">
                            </div>
                            <div>
                                <label style="font-size: 0.9em; color: #666; margin-bottom: 5px; font-weight: 600; display: block;">Segmento:</label>
                                <select id="segmentFilter" style="padding: 10px; border: 2px solid #ddd; border-radius: 5px; width: 100%; font-size: 0.95em;">
                                    <option value="">Todos</option>
                                    <option value="PLATINO">ü•á PLATINO</option>
                                    <option value="ORO">ü•à ORO</option>
                                    <option value="PLATA">ü•â PLATA</option>
                                    <option value="BRONCE">üî∂ BRONCE</option>
                                    <option value="BLACK">‚ö´ BLACK</option>
                                </select>
                            </div>
                            <div style="display: flex; align-items: flex-end;">
                                <button onclick="loadMetricsData()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: 600; width: 100%; transition: background 0.3s;">
                                    üîÑ Cargar M√©tricas
                                </button>
                            </div>
                        </div>

                        <div id="metricsLoading" style="text-align: center; padding: 40px; display: none;">
                            <div style="border: 4px solid rgba(102,126,234,0.3); border-radius: 50%; border-top: 4px solid #667eea; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
                            <p style="font-size: 1.1em; color: #666;">Cargando m√©tricas...</p>
                        </div>

                        <div id="metricsContent" style="display: none;">
                            <!-- Tarjetas de estad√≠sticas -->
                            <div id="statsGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;"></div>

                            <!-- Gr√°ficas -->
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px;">
                                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); position: relative; height: 350px;">
                                    <div style="font-size: 1.1em; font-weight: 600; margin-bottom: 15px; color: #333;">Ventas por Segmento</div>
                                    <div style="position: relative; height: 280px;">
                                        <canvas id="segmentChart"></canvas>
                                    </div>
                                </div>
                                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); position: relative; height: 350px;">
                                    <div style="font-size: 1.1em; font-weight: 600; margin-bottom: 15px; color: #333;">Tendencia de Ventas</div>
                                    <div style="position: relative; height: 280px;">
                                        <canvas id="trendChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <style>
                    @keyframes spin {
                        0% { transform: rotate(0deg); }
                        100% { transform: rotate(360deg); }
                    }
                    .stat-card {
                        background: white;
                        padding: 15px;
                        border-radius: 8px;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                        text-align: center;
                    }
                    .stat-card h3 {
                        color: #666;
                        font-size: 0.85em;
                        margin-bottom: 8px;
                        text-transform: uppercase;
                    }
                    .stat-value {
                        font-size: 2em;
                        font-weight: bold;
                        color: #667eea;
                    }
                    
                    /* Estilos para gr√°ficos del dashboard */
                    .charts-container {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 20px;
                        margin-top: 30px;
                    }
                    
                    @media (max-width: 768px) {
                        .charts-container {
                            grid-template-columns: 1fr;
                        }
                    }
                    
                    .chart-card {
                        background: white;
                        padding: 20px;
                        border-radius: 12px;
                        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                        position: relative;
                    }
                    
                    .chart-title {
                        margin: 0 0 15px 0;
                        font-size: 0.95em;
                        color: #333;
                        font-weight: 600;
                    }
                    
                        .chart-wrapper {
                            position: relative;
                            height: 250px;
                            width: 100%;
                            overflow: hidden;
                        }
                    
                        .chart-wrapper canvas {
                            max-width: 100% !important;
                            height: 100% !important;
                            display: block;
                        }
                </style>

                <script type="module">
                    import { app, auth, db, functions } from './js/firebase-config.js';
                    import { httpsCallable } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-functions.js';

                    let segmentChart = null;
                    let trendChart = null;
                    
                    // Variables globales para los gr√°ficos
                    window.segmentChartSimple = null;
                    window.scoreChartSimple = null;

                    // Establecer fecha por defecto
                    function setDefaultDate() {
                        const dateInput = document.getElementById('dateFilter');
                        const today = new Date();
                        const period = document.getElementById('periodFilter').value;

                        if (period === 'day') {
                            dateInput.type = 'date';
                            dateInput.value = today.toISOString().split('T')[0];
                        } else if (period === 'month') {
                            dateInput.type = 'month';
                            dateInput.value = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}`;
                        } else {
                            dateInput.type = 'number';
                            dateInput.value = today.getFullYear();
                            dateInput.min = 2020;
                            dateInput.max = today.getFullYear();
                        }
                    }

                    document.getElementById('periodFilter').addEventListener('change', setDefaultDate);
                    setDefaultDate();

                    window.loadMetricsData = async function() {
                        try {
                            console.log('üîÑ Cargando m√©tricas (versi√≥n directa)...');
                            document.getElementById('metricsLoading').style.display = 'block';
                            document.getElementById('metricsContent').style.display = 'none';

                            // Usar nuestro script de m√©tricas directas en lugar de Cloud Functions
                            const metrics = await getMetricsDirectly();
                            
                            if (metrics) {
                                // Convertir al formato esperado por displayMetrics
                                const result = {
                                    total: metrics.total,
                                    bySegment: {
                                        PLATINO: metrics.platino,
                                        ORO: metrics.oro,
                                        PLATA: metrics.plata,
                                        BRONCE: metrics.bronce,
                                        BLACK: metrics.black
                                    },
                                    ventas: [] // Para el gr√°fico de tendencias (temporal)
                                };

                                document.getElementById('metricsLoading').style.display = 'none';
                                document.getElementById('metricsContent').style.display = 'block';

                                displayMetrics(result, 'mensual');
                                console.log('‚úÖ M√©tricas cargadas exitosamente');
                            } else {
                                throw new Error('No se pudieron obtener las m√©tricas');
                            }

                        } catch (error) {
                            console.error('‚ùå Error cargando m√©tricas:', error);
                            
                            // Mostrar error pero intentar cargar datos b√°sicos
                            document.getElementById('metricsLoading').style.display = 'none';
                            document.getElementById('metricsContent').style.display = 'block';
                            
                            // Mostrar mensaje de error en lugar de alert
                            const statsGrid = document.getElementById('statsGrid');
                            if (statsGrid) {
                                statsGrid.innerHTML = `
                                    <div class="stat-card" style="background: #fee; border-left: 4px solid #f44;">
                                        <h3>‚ö†Ô∏è Error</h3>
                                        <div class="stat-value" style="font-size: 14px;">No se pudieron cargar las m√©tricas. Revisa la consola.</div>
                                    </div>
                                `;
                            }
                        }
                    };

                    function displayMetrics(data, period) {
                        console.log('üìä Mostrando m√©tricas:', data);
                        
                        // 1. Actualizar tarjetas de estad√≠sticas (si el contenedor existe)
                        const statsGrid = document.getElementById('statsGrid');
                        if (statsGrid) {
                            statsGrid.innerHTML = '';
                            statsGrid.innerHTML += `
                                <div class="stat-card">
                                    <h3>Total</h3>
                                    <div class="stat-value">${data.total}</div>
                                </div>
                            `;

                            const segments = ['PLATINO', 'ORO', 'PLATA', 'BRONCE', 'BLACK'];
                            segments.forEach(seg => {
                                const count = data.bySegment[seg] || 0;
                                statsGrid.innerHTML += `
                                    <div class="stat-card">
                                        <h3>${seg}</h3>
                                        <div class="stat-value">${count}</div>
                                    </div>
                                `;
                            });
                        }

                        // 2. Actualizar gr√°ficos principales y simples
                        updateSegmentChart(data.bySegment);
                        updateSegmentChartSimple(data.bySegment);
                        updateScoreChartSimple(data.bySegment);
                        updateTrendChart(data.ventas, period);
                    }

                    function updateSegmentChart(bySegment) {
                        const ctx = document.getElementById('segmentChart').getContext('2d');

                        if (segmentChart) {
                            segmentChart.destroy();
                        }

                        const segments = ['PLATINO', 'ORO', 'PLATA', 'BRONCE', 'BLACK'];
                        const colors = ['#FFD700', '#C0C0C0', '#A9A9A9', '#CD7F32', '#000000'];
                        const chartData = segments.map(seg => bySegment[seg] || 0);

                        segmentChart = new Chart(ctx, {
                            type: 'doughnut',
                            data: {
                                labels: segments,
                                datasets: [{
                                    data: chartData,
                                    backgroundColor: colors,
                                    borderColor: '#fff',
                                    borderWidth: 2
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: true,
                                plugins: {
                                    legend: {
                                        position: 'bottom',
                                        labels: {
                                            padding: 15,
                                            font: { size: 12 }
                                        }
                                    }
                                }
                            }
                        });
                    }

                    function updateTrendChart(ventas, period) {
                        const ctx = document.getElementById('trendChart').getContext('2d');

                        if (trendChart) {
                            trendChart.destroy();
                        }

                        const grouped = {};
                        ventas.forEach(venta => {
                            const key = period === 'day' ? venta.dateStr : 
                                       period === 'month' ? venta.monthStr : 
                                       venta.year.toString();
                            grouped[key] = (grouped[key] || 0) + 1;
                        });

                        const labels = Object.keys(grouped).sort();
                        const chartData = labels.map(key => grouped[key]);

                        trendChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: labels,
                                datasets: [{
                                    label: 'Ventas',
                                    data: chartData,
                                    borderColor: '#667eea',
                                    backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                    borderWidth: 2,
                                    fill: true,
                                    tension: 0.4,
                                    pointRadius: 5,
                                    pointBackgroundColor: '#667eea',
                                    pointBorderColor: '#fff',
                                    pointBorderWidth: 2
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: true,
                                plugins: {
                                    legend: {
                                        display: true,
                                        position: 'top',
                                        labels: {
                                            padding: 15,
                                            font: { size: 12 }
                                        }
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true
                                    }
                                }
                            }
                        });
                    }

                    // Funci√≥n para actualizar el gr√°fico simple de segmentos
                    function updateSegmentChartSimple(bySegment) {
                        const canvas = document.getElementById('segmentChartSimple');
                        if (!canvas) return;
                        
                        const ctx = canvas.getContext('2d');

                        // Destruir gr√°fico existente si hay uno
                        if (window.segmentChartSimple) {
                            window.segmentChartSimple.destroy();
                        }

                        const segments = ['PLATINO', 'ORO', 'PLATA', 'BRONCE', 'BLACK'];
                        const colors = ['#FFD700', '#FFA500', '#C0C0C0', '#CD7F32', '#2F2F2F'];
                        const chartData = segments.map(seg => bySegment[seg] || 0);
                        
                        const totalClients = chartData.reduce((a, b) => a + b, 0);
                        
                        if (totalClients === 0) {
                            // Mostrar mensaje si no hay datos
                            ctx.clearRect(0, 0, canvas.width, canvas.height);
                            ctx.fillStyle = '#666';
                            ctx.font = '14px Arial';
                            ctx.textAlign = 'center';
                            ctx.fillText('No hay datos', canvas.width / 2, canvas.height / 2);
                            return;
                        }

                        window.segmentChartSimple = new Chart(ctx, {
                            type: 'doughnut',
                            data: {
                                labels: segments,
                                datasets: [{
                                    data: chartData,
                                    backgroundColor: colors,
                                    borderWidth: 2,
                                    borderColor: '#fff'
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        position: 'bottom',
                                        labels: {
                                            padding: 8,
                                            font: { size: 10 }
                                        }
                                    }
                                }
                            }
                        });

                        console.log('‚úÖ Gr√°fico simple actualizado con datos:', chartData);
                    }

                    // Funci√≥n para actualizar el segundo gr√°fico (tendencia)
                    function updateScoreChartSimple(bySegment) {
                        const canvas = document.getElementById('scoreChartSimple');
                        if (!canvas) return;
                        
                        const ctx = canvas.getContext('2d');

                        // Destruir gr√°fico existente si hay uno
                        if (window.scoreChartSimple) {
                            window.scoreChartSimple.destroy();
                        }

                        const segments = ['PLATINO', 'ORO', 'PLATA', 'BRONCE', 'BLACK'];
                        const colors = ['#FFD700', '#FFA500', '#C0C0C0', '#CD7F32', '#2F2F2F'];
                        const chartData = segments.map(seg => bySegment[seg] || 0);
                        
                        const totalClients = chartData.reduce((a, b) => a + b, 0);
                        
                        if (totalClients === 0) {
                            // Mostrar mensaje si no hay datos
                            ctx.clearRect(0, 0, canvas.width, canvas.height);
                            ctx.fillStyle = '#666';
                            ctx.font = '14px Arial';
                            ctx.textAlign = 'center';
                            ctx.fillText('No hay datos', canvas.width / 2, canvas.height / 2);
                            return;
                        }

                        window.scoreChartSimple = new Chart(ctx, {
                            type: 'bar',
                            data: {
                                labels: segments,
                                datasets: [{
                                    label: 'Clientes por Segmento',
                                    data: chartData,
                                    backgroundColor: colors,
                                    borderWidth: 1,
                                    borderColor: colors.map(color => color + '80')
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        ticks: {
                                            stepSize: 1
                                        }
                                    }
                                }
                            }
                        });

                        console.log('‚úÖ Gr√°fico de barras actualizado con datos:', chartData);
                    }

                    // Cargar datos al abrir la pesta√±a
                    window.addEventListener('load', () => {
                        setTimeout(() => {
                            loadMetricsData();
                        }, 500);
                    });
                </script>
            </div>

            <!-- Pesta√±a: Pipeline de Ventas -->
            <div id="tab-pipeline" class="tab-content">
                <section class="main-section">
                    <h2>üìà Pipeline de Ventas</h2>
                    <div id="pipelineContainer" class="pipeline-container">
                        <!-- Cargar√° din√°micamente -->
                    </div>
                </section>
            </div>

            <!-- Pesta√±a: Seguimiento de Pedidos -->
            <div id="tab-contactos" class="tab-content">
                <section class="data-section">
                    <h2>ÔøΩ Seguimiento de Pedidos</h2>
                    
                    <!-- Stats R√°pidas -->
                    <div class="orders-stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">‚è≥</div>
                            <div class="stat-content">
                                <p class="stat-label">Pedidos Pendientes</p>
                                <p class="stat-value" id="ordersPendingCount">0</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚úÖ</div>
                            <div class="stat-content">
                                <p class="stat-label">Pedidos Enviados</p>
                                <p class="stat-value" id="ordersSentCount">0</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìä</div>
                            <div class="stat-content">
                                <p class="stat-label">Total de Pedidos</p>
                                <p class="stat-value" id="ordersTotalCount">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Formulario de Registro de Pedidos -->
                    <div class="orders-form-container">
                        <h3>üìù Registrar Nuevo Pedido</h3>
                        <form id="ordersForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="orderNumber">N√∫mero de Pedido: *</label>
                                    <input type="text" id="orderNumber" required placeholder="Ej: KO-50734124 o 1-10245886908">
                                </div>
                                <div class="form-group">
                                    <label for="orderIMEI">IMEI / Accesorio: *</label>
                                    <input type="text" id="orderIMEI" required placeholder="IMEI o c√≥digo del accesorio">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="orderType">Tipo de Plataforma: *</label>
                                    <select id="orderType" required>
                                        <option value="">Selecciona...</option>
                                        <option value="KOMERCIAL">KO - Komercial</option>
                                        <option value="SIEBEL">SB - Siebel</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="orderClient">Cliente (Opcional):</label>
                                    <input type="text" id="orderClient" placeholder="Nombre del cliente">
                                </div>
                            </div>
                            <div class="button-group">
                                <button type="submit" class="btn btn-success">üì¶ Registrar Pedido</button>
                                <button type="reset" class="btn btn-secondary">Limpiar</button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Gr√°ficas de An√°lisis -->
                    <h3 style="margin-top: 32px; margin-bottom: 20px;">üìä An√°lisis de Pedidos</h3>
                    <div class="charts-container">
                        <div class="chart-card expandable" id="card-orders-status">
                            <h3>Estado de Pedidos</h3>
                            <canvas id="ordersStatusChart" width="400" height="200"></canvas>
                        </div>
                        <div class="chart-card expandable" id="card-orders-day">
                            <h3>Pedidos por D√≠a</h3>
                            <canvas id="ordersDayChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                    
                    <!-- Lista de Pedidos -->
                    <h3 style="margin-top: 32px; margin-bottom: 20px;">üìã √öltimos Pedidos</h3>
                    <div id="ordersList" class="orders-list">
                        <p class="empty-message">No hay pedidos registrados a√∫n.</p>
                    </div>
                </section>
            </div>

            <!-- Pesta√±a: Campa√±as -->
            <div id="tab-campanas" class="tab-content">
                <section class="main-section">
                    <h2>üìß Campa√±as</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <h3>Crear Nueva Campa√±a</h3>
                            <form id="campaignForm">
                                <div class="form-group">
                                    <label>Asunto:</label>
                                    <input type="text" id="campaignSubject" required placeholder="Titulo de la campa√±a">
                                </div>
                                <div class="form-group">
                                    <label>Mensaje:</label>
                                    <textarea id="campaignMessage" required placeholder="Contenido del mensaje" rows="4"></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Segmento:</label>
                                    <select id="campaignSegment" required>
                                        <option value="">Selecciona segmento</option>
                                        <option value="PLATINO">PLATINO</option>
                                        <option value="ORO">ORO</option>
                                        <option value="PLATA">PLATA</option>
                                        <option value="BRONCE">BRONCE</option>
                                        <option value="TODOS">TODOS</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-success">üì§ Enviar Campa√±a</button>
                            </form>
                        </div>
                        <div>
                            <h3>Historial de Campa√±as</h3>
                            <div id="campaignsHistory" class="campaigns-history">
                                <!-- Cargar√° din√°micamente -->
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Pesta√±a: Gesti√≥n de Llamadas -->
            <div id="tab-actividades" class="tab-content">
                <section class="data-section">
                    <h2>üìû Gesti√≥n de Llamadas</h2>
                    
                    <!-- Stats R√°pidas -->
                    <div class="calls-stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üìû</div>
                            <div class="stat-content">
                                <p class="stat-label">Llamadas Hoy</p>
                                <p class="stat-value" id="callsTodayCount">0</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚úÖ</div>
                            <div class="stat-content">
                                <p class="stat-label">Tasa de √âxito</p>
                                <p class="stat-value" id="callsSuccessRate">0%</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚è±Ô∏è</div>
                            <div class="stat-content">
                                <p class="stat-label">Duraci√≥n Promedio</p>
                                <p class="stat-value" id="callsAvgDuration">0m</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚è≥</div>
                            <div class="stat-content">
                                <p class="stat-label">Pendientes</p>
                                <p class="stat-value" id="callsPending">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Formulario Registro de Llamadas -->
                    <div class="calls-form-container">
                        <h3>üìù Registrar Nueva Llamada</h3>
                        <form id="callsForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="callClientId">Cliente: *</label>
                                    <select id="callClientId" required>
                                        <option value="">Seleccione cliente...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="callDuration">Duraci√≥n (minutos): *</label>
                                    <input type="number" id="callDuration" required min="1" placeholder="5" value="5">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="callResult">Resultado: *</label>
                                    <select id="callResult" required>
                                        <option value="">Seleccione...</option>
                                        <option value="EXITOSO">‚úÖ Exitoso</option>
                                        <option value="PENDIENTE">‚è≥ Pendiente</option>
                                        <option value="RECHAZADO">‚ùå Rechazado</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="callNotes">Notas:</label>
                                    <input type="text" id="callNotes" placeholder="Detalles de la llamada">
                                </div>
                            </div>
                            <div class="button-group">
                                <button type="submit" class="btn btn-success">üíæ Registrar Llamada</button>
                                <button type="reset" class="btn btn-secondary">Limpiar</button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Gr√°ficas de An√°lisis -->
                    <h3 style="margin-top: 32px; margin-bottom: 20px;">üìä An√°lisis de Llamadas</h3>
                    <div class="charts-container">
                        <div class="chart-card expandable" id="card-calls-day">
                            <h3>Llamadas por D√≠a</h3>
                            <canvas id="callsDayChart" width="400" height="200"></canvas>
                        </div>
                        <div class="chart-card expandable" id="card-calls-result">
                            <h3>Distribuci√≥n de Resultados</h3>
                            <canvas id="callsResultChart" width="400" height="200"></canvas>
                        </div>
                        <div class="chart-card expandable" id="card-calls-duration">
                            <h3>Duraci√≥n Promedio por Cliente</h3>
                            <canvas id="callsDurationChart" width="400" height="200"></canvas>
                        </div>
                        <div class="chart-card expandable" id="card-calls-cumulative">
                            <h3>Volumen Acumulado</h3>
                            <canvas id="callsCumulativeChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                    
                    <!-- Lista de Llamadas -->
                    <h3 style="margin-top: 32px; margin-bottom: 20px;">üìã √öltimas Llamadas</h3>
                    <div id="callsList" class="calls-list">
                        <p class="empty-message">No hay llamadas registradas a√∫n.</p>
                    </div>
                </section>
            </div>
        </main>

        <footer>
            <p>Executive Performance ICE ¬© 2025 - Sistema de Gesti√≥n de Clientes</p>
        </footer>
    </div>

    <!-- Footer con Cr√©ditos -->
    <footer class="app-footer">
        <div class="footer-content">
            <div class="footer-left">
                <span class="powered-by">üöÄ Powered by <strong>Infinix Dev</strong></span>
            </div>
            <div class="footer-right">
                <span><strong>Rub√©n Madrigal</strong> ‚Ä¢ Arquitecto</span>
                <span class="footer-divider">‚Ä¢</span>
                <span><a href="#" onclick="showCredits(); return false;">Cr√©ditos</a></span>
            </div>
        </div>
    </footer>

    <!-- Modal de Cr√©ditos -->
    <div id="creditsModal" class="modal hidden">
        <div class="modal-content credits-modal">
            <button class="modal-close" onclick="closeCredits()">&times;</button>
            
            <div class="credits-header">
                <h2>üèóÔ∏è Acerca de Este Proyecto</h2>
            </div>

            <div class="credits-body">
                <section class="credit-section">
                    <h3>üë®‚Äçüíº Creador & Arquitecto</h3>
                    <p><strong>Rub√©n Madrigal</strong></p>
                    <p class="subtitle">Arquitecto de Soluciones Tecnol√≥gicas</p>
                </section>

                <section class="credit-section">
                    <h3>üè¢ Empresa</h3>
                    <p><strong>Infinix Dev</strong></p>
                    <p class="subtitle">Solutions that transform</p>
                    <p><a href="https://infinixdev.com" target="_blank">www.infinixdev.com</a></p>
                </section>

                <section class="credit-section">
                    <h3>üìã Informaci√≥n del Proyecto</h3>
                    <p><strong>Nombre:</strong> Executive Performance CRM</p>
                    <p><strong>Versi√≥n:</strong> 1.0</p>
                    <p><strong>Cliente:</strong> ICE (Instituto Costarricense de Electricidad)</p>
                </section>

                <section class="credit-section">
                    <h3>üîê Licencia</h3>
                    <div class="license-box">
                        <p><strong>N√∫mero de Licencia:</strong></p>
                        <p class="license-number">LIC-INFINIX-2024-EP-001</p>
                        <p style="margin-top: 12px; font-size: 0.9rem; color: #666;">
                            ¬© 2024 Infinix Dev. Todos los derechos reservados.
                        </p>
                    </div>
                </section>

                <section class="credit-section">
                    <h3>üíª Stack Tecnol√≥gico</h3>
                    <div class="tech-grid">
                        <div class="tech-item">
                            <span class="tech-badge">Node.js</span>
                            <span class="tech-badge">Express</span>
                        </div>
                        <div class="tech-item">
                            <span class="tech-badge">Firebase</span>
                            <span class="tech-badge">Firestore</span>
                        </div>
                        <div class="tech-item">
                            <span class="tech-badge">HTML5</span>
                            <span class="tech-badge">CSS3</span>
                            <span class="tech-badge">JavaScript</span>
                        </div>
                    </div>
                </section>

                <section class="credit-section">
                    <h3>‚ú® Caracter√≠sticas</h3>
                    <ul class="features-list">
                        <li>8 tabs funcionales con todas las features</li>
                        <li>Sistema de gesti√≥n de clientes completo (CRUD)</li>
                        <li>Dashboard con m√©tricas y gr√°ficos en tiempo real</li>
                        <li>Sistema de metas basado en ventas</li>
                        <li>Pipeline de ventas con 5 estados</li>
                        <li>Reportes de contactos con filtros avanzados</li>
                        <li>Campa√±as masivas por segmento</li>
                        <li>Control de acceso basado en roles</li>
                        <li>Exportaci√≥n a Excel</li>
                        <li>Sistema de recordatorios inteligentes</li>
                    </ul>
                </section>

                <section class="credit-section">
                    <h3>üìÖ Informaci√≥n Adicional</h3>
                    <p><strong>Fecha de Creaci√≥n:</strong> Noviembre 2024</p>
                    <p><strong>Estado:</strong> Producci√≥n Ready ‚úÖ</p>
                    <p><strong>Tipo de Proyecto:</strong> CRM Empresarial</p>
                </section>
            </div>

            <div class="credits-footer-modal">
                <p>Executive Performance ¬© 2024 | Creado por Infinix Dev</p>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/firebase@9.23.0/dist/firebase-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/firebase@9.23.0/dist/firebase-auth.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/firebase@9.23.0/dist/firebase-firestore.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/firebase@9.23.0/dist/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/firebase@9.23.0/dist/firebase-storage.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/firebase@9.23.0/dist/firebase-functions.js"></script>
    
    <!-- ‚úÖ VALIDACI√ìN SEGURA DE DATOS - Cargar primero -->
    <script src="js/safe-data-validation.js"></script>
    
    <!-- üîß SOLUCI√ìN TEMPORAL: M√©tricas directas mientras se arreglan las functions -->
    <script type="module" src="js/direct-metrics.js?v=20251116003"></script>
    
    <script type="module" src="js/firebase-config.js"></script>
    
    <script>
        // Esperar a que Firebase est√© listo antes de cargar otros scripts
        function waitForFirebase() {
            if (typeof firebase !== 'undefined' && firebase.apps.length > 0) {
                console.log('‚úÖ Firebase cargado correctamente');
                // Cargar m√≥dulos que dependen de Firebase
                loadTrackingModules();
            } else {
                setTimeout(waitForFirebase, 100);
            }
        }
        
        function loadTrackingModules() {
            // Cargar din√°micamente despu√©s de Firebase
            const scripts = [
                'js/calls-tracking.js',
                'js/calls-management.js',
                'js/orders-tracking.js',
                'js/orders-management.js'
            ];
            
            scripts.forEach(src => {
                const script = document.createElement('script');
                script.src = src;
                document.body.appendChild(script);
            });
        }
        
        // Esperar a que Firebase est√© listo
        setTimeout(waitForFirebase, 500);
    </script>
    
    <script type="module" src="js/auth.js"></script>
    <script type="module" src="js/sales-tracking.js"></script>
    <script type="module" src="js/clients.js"></script>
    <!-- Eliminada segunda inclusi√≥n duplicada de dashboard.js -->
    <script type="module" src="js/executive-features.js"></script>
    <script type="module" src="js/advanced-features.js"></script>

    <script>
        // Funciones de cr√©ditos
        function showCredits() {
            document.getElementById('creditsModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeCredits() {
            document.getElementById('creditsModal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // Cerrar modal al hacer clic fuera
        document.getElementById('creditsModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeCredits();
            }
        });
    </script>

    <!-- Scripts de Seguridad y Monitoreo (Nuevos) -->
    <script src="js/security.js"></script>
    <script src="js/error-handler.js"></script>
    <script src="js/monitoring.js"></script>
    <script src="js/retry-handler.js"></script>
    <!-- SheetJS debe ir antes de los scripts principales para exportar -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script type="module" src="js/clients.js"></script>
    <script src="js/dashboard.js"></script>
    <script type="module" src="js/executive-features.js"></script>
    <script type="module" src="js/advanced-features.js"></script>
    </body>
    <!-- Script de gr√°ficas profesionales del dashboard -->
    <script src="js/charts-dashboard.js"></script>
    </html>
</body>
</html>